name: generate_spec_pdf
on:
  push:
    branches:
      - working_draft
      - maintenance/**

jobs:
    # The job that will use the container image you just pushed to ghcr.io
    gen_pdf:
        runs-on: ubuntu-20.04
        container:
            image: pandoc/extra:latest-ubuntu
        steps:
            - name: Check out repository code
              uses: actions/checkout@v3
            - name: Install prequirements
              shell: bash
              run: |
                /usr/bin/apt-get -y update
                wget https://github.com/wkhtmltopdf/packaging/releases/download/0.12.6.1-2/wkhtmltox_0.12.6.1-2.jammy_amd64.deb
                DEBIAN_FRONTEND=noninteractive /usr/bin/apt install -y make
                DEBIAN_FRONTEND=noninteractive /usr/bin/apt install -y -f ./wkhtmltox_0.12.6.1-2.jammy_amd64.deb
                /usr/bin/pip3 install markdownpp pymarkdownlnt
            - name: Build PDF
              shell: bash
              working-directory: ./specification
              run: |
                make STYLE=working_draft
            - name: Upload Spec
              uses: actions/upload-artifact@v3.1.2
              with:
                name: FOCUS_specification
                path: |
                  specification/spec.html
                  specification/spec.pdf
                  specification/images/*
                  specification/styles/*
